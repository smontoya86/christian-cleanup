{# 
Song Row Component - SIMPLIFIED
Expected: item with 'song', 'analysis', 'position', 'is_whitelisted'
#}

<tr class="song-row {{ 'table-info' if item.is_whitelisted else '' }}" data-song-id="{{ item.song.id }}">
    <!-- Position -->
    <td class="text-center">{{ item.position }}</td>
    
    <!-- Album Art -->
    <td class="text-center">
        <a href="{{ url_for('main.song_detail', song_id=item.song.id) }}" class="text-decoration-none">
            <img src="{{ item.song.album_art_url or url_for('static', filename='images/default_album_art.png') }}" 
                 alt="Album Art" class="rounded" 
                 style="width: 50px !important; height: 50px !important; object-fit: cover !important; display: block !important; margin: 0 auto !important;">
        </a>
    </td>
    
    <!-- Song Title & Artist -->
    <td>
        <div class="d-flex flex-column">
            <a href="{{ url_for('main.song_detail', song_id=item.song.id) }}" class="text-decoration-none fw-bold song-title">
                {{ item.song.title }}
            </a>
            <span class="text-muted small song-artist">{{ item.song.artist }}</span>
        </div>
    </td>
    
    <!-- Album -->
    <td>{{ item.song.album or 'Unknown Album' }}</td>
    
    <!-- Analysis Score -->
    <td class="score-cell">
        {% if item.analysis and item.analysis.score is not none %}
            <span class="badge bg-{{ 'danger' if item.analysis.concern_level|lower == 'high' else 'warning' if item.analysis.concern_level|lower == 'medium' else 'success' }} fs-6">
                {{ "%.0f"|format(item.analysis.score) }}%
            </span>
            <div class="small text-muted">{{ item.analysis.concern_level|title }}</div>
        {% else %}
            <span class="text-muted">Not Analyzed</span>
        {% endif %}
    </td>
    
    <!-- Actions -->
    <td>
        {% if item.is_whitelisted %}
            <span class="badge bg-success">âœ“ Whitelisted</span>
        {% elif item.analysis and item.analysis.concern_level|lower in ['high', 'extreme'] %}
            <a href="{{ url_for('main.song_detail', song_id=item.song.id) }}" class="btn btn-sm btn-warning">
                Review
            </a>
        {% else %}
            <button type="button" class="btn btn-sm btn-primary analyze-song-btn" 
                    data-song-id="{{ item.song.id }}"
                    data-song-title="{{ item.song.title }}"
                    data-song-artist="{{ item.song.artist }}">
                Analyze
            </button>
        {% endif %}
    </td>
</tr> 